# yaml-language-server: $schema=https://raw.githubusercontent.com/prefix-dev/recipe-format/73cd2eed94c576213c5f25ab57adf6d8c83e792a/schema.json
schema_version: 1

context:
  name: "pipefunc"
  version: "0.55.2"
  python_min: "3.10"
  # Set PYTHON to the value from the environment if available, otherwise default to "$PYTHON"
  PYTHON: "$PYTHON"

recipe:
  name: ${{ name }}
  version: ${{ version }}

source:
  url: https://pypi.org/packages/source/${{ name[0] }}/${{ name }}/pipefunc-${{ version }}.tar.gz
  sha256: 73938378c6fa628540088ef720ef7f5cc27827c0cb05407a6a7d670ff0cb78da

build:
  number: 0

outputs:
  - package:
      name: ${{ name }}
      version: ${{ version }}
    build:
      noarch: python
      script: ${{ PYTHON }} -m pip install . -vv
    requirements:
      host:
        - python ${{ python_min }}.*
        - hatchling
        - wheel
        - versioningit
        - pip
      run:
        - python >=${{ python_min }}
        - networkx
        - psutil
        - cloudpickle
        - numpy
    tests:
      - python:
          imports:
            - pipefunc
      - script:
          - pip check
        extra_requirements:
          run:
            - pip
            - python ${{ python_min }}

  - package:
      name: ${{ name }}-extras
      version: ${{ version }}
    build:
      noarch: generic
    requirements:
      run:
        - ${{ pin_subpackage(name, exact=True) }}
        - adaptive
        - graphviz
        - graphviz-anywidget
        - griffe
        - ipywidgets
        - matplotlib-base
        - pandas
        - psutil
        - pydantic
        - rich
        - rich-argparse
        - xarray
        - "zarr <3"
    tests:
      - python:
          imports:
            - pipefunc

about:
  homepage: https://github.com/pipefunc/pipefunc
  summary: A Python library for defining, managing, and executing function pipelines.
  license: MIT
  license_file: LICENSE

extra:
  recipe-maintainers:
    - basnijholt
